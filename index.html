<head>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles/simulation.css">
  <link rel="stylesheet" href="styles/about.css">
  <link rel="stylesheet" href="styles/agentChat.css">
  <link rel="stylesheet" href="styles/chathistory.css">
  <style>
    body {
      margin: 0;
      overflow:scroll;
      
    }
    canvas {
      display: block;
      margin: 0 auto; /* Centers the canvas horizontally */

    }
    
    /* Add a container for better control */
    .container {
      display: flex;
      justify-content: center; /* Centers content horizontally */
      align-items: center; /* Centers content vertically */
      min-height: 100vh; /* Ensures canvas is vertically centered on the screen */
      padding: 20px; /* Adds breathing room */
      box-sizing: border-box; /* Includes padding in element dimensions */
    }
    
    /* Optional styles for body scrolling */
    body::-webkit-scrollbar {
      width: 10px; /* Adjust scrollbar width */
    }
    
    body::-webkit-scrollbar-track {
      background: #f4f4f9; /* Track color */
    }
    
    body::-webkit-scrollbar-thumb {
      background-color: #aaa; /* Thumb color */
      border-radius: 10px; /* Rounded edges for smooth look */
      border: 2px solid #f4f4f9; /* Inner border for contrast */
    }

    .solona-logo {
      position: fixed;
      top: 10px;
      right: 10px;
      width: 100px; /* Set the desired size */
      height: auto;
      z-index: 1000; /* Ensure it stays on top */
    }


    .buttons-container {
      position: fixed;
      bottom: 20px; /* Distance from the bottom */
      right: 20px;  /* Distance from the right */
      display: flex;
      gap: 10px; /* Space between the buttons */
      z-index: 1000; /* Ensure buttons are on top */
    }

    #orientation-warning {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color:black;
      color: white;
      font-size: 22px;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      text-align: center;
      padding: 2rem;
    }

    @media screen and (orientation: portrait) {
      #orientation-warning {
        display: flex;
      }
    }

    @media screen and (orientation: landscape) {
      #orientation-warning {
        display: none;
      }
    }

    /* Style for individual buttons */
    .button {
      background-color: #1f221f; /* Green background */
      border: none;
      color: rgb(245, 245, 245);
      padding: 7px 5px;
      text-align: center;
      display: inline-block;
      font-size: 14px;
      border: 2px solid #79d70f; /* Neon green border */
      box-shadow: 0 2px 4px rgba(0, 255, 0, 0.8); /* Neon shadow */
      font-family: 'Press Start 2P', cursive;
      cursor: pointer;
      border-radius: 8px;
      transition: background-color 0.3s ease;
    }

    /* Hover effect for buttons */
    .button:hover {
      background-color: #45a049;
    }
  </style>
    <script>
  if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
    document.documentElement.style.zoom = "30%";
  }
</script>
</head>
<body>
<img src="img/solana.png" alt="Solona Logo" style="width: 40px; height: 40px;" class="solona-logo">
 <div class="buttons-container">
    <button class="button" id="connectWalletButton">Connect Wallet</button>
    <button class="button" id="animalchat">Finite backroom</button>
    <button  class="button" id="aboutButton">About</button>
    <button class="button" id="musicButton">Music</button>
    <audio id="audioPlayer" src="audio/victory.wav"></audio>
  
  <a href="https://x.com/deepverseai" style="text-decoration: none;">
  <button style="width: 30px; height: 30px; border: none; border-radius: 30%; font-size: 20px; background-color:  #333; color: white; display: flex; align-items: center; justify-content: center; cursor: pointer;">
    <i class="fab fa-twitter"></i>
  </button>
</a>

<a href="https://github.com/Malinhara/deepverse" style="text-decoration: none;">
  <button style="width: 30px; height: 30px; border: none; border-radius: 30%; font-size: 20px; background-color: #333; color: white; display: flex; align-items: center; justify-content: center; cursor: pointer;">
    <i class="fab fa-github"></i>
  </button>
</a>
  </div>


  <div class="sidebar">
    <div class="title-box">
      aiVERSE
    </div>
    <div class="agents-box">
      <div class="agents-header">
        <div>Agents in-play:</div>
      
      </div>
    <div class="agent-list">
        <!-- <div class="agent-row" onclick="openModal('ponke@gmail.com')">
          <span class="agent-name">Ponke</span>
          <button class="vote-button" style="  margin-left:22%;" >Chat</button>
          <div class="vote-count">
           
          </div>
        </div> -->
        <div class="agent-row" onclick="openModal('pepe@gmail.com')">
          <span class="agent-name">Tencent Yuanbao</span>
          <button class="vote-button" style="margin-left:27%;" >Chat</button>
          <div class="vote-count">
           
            
          </div>
        </div>
        <!-- <div class="agent-row" onclick="openModal('popcat@gmail.com')">
          <span class="agent-name">Popcat</span>
          <button class="vote-button" style="margin-left:16%;">Chat</button>
          <div class="vote-count">

          </div>
        </div> -->
        <div class="agent-row" onclick="openModal('doge@gmail.com')">
          <span class="agent-name">Perplexity</span>
          <button class="vote-button" style="margin-left:10%;">Chat</button>
          <div class="vote-count">

          </div>
        </div>
        <div class="agent-row" onclick="openModal('duk@gmail.com')">
          <span class="agent-name">DeepSeek</span>
          <button class="vote-button" style="margin-left:20%;">Chat</button>
          <div class="vote-count">

          </div>
        </div>
        <div class="agent-row" onclick="openModal('pnut@gmail.com')">
          <span class="agent-name">Moonshot Kimi</span>
          <button class="vote-button" style="margin-left:6%;">Chat</button>
          <div class="vote-count">

          </div>
        </div>
        <div class="agent-row" onclick="openModal('bobo@gmail.com')">
          <span class="agent-name">Alibaba Qwen </span>
          <button class="vote-button" style="margin-left:25%;">Chat</button>
          <div class="vote-count">
           

          </div>
        </div>
        <div class="agent-row" onclick="openModal('goatseus@gmail.com')">
          <span class="agent-name">Gemini</span>
          <button class="vote-button" style="margin-left:34%;">Chat</button>
          <div class="vote-count">
           

          </div>
        </div>
        <div class="agent-row" onclick="openModal('moodeng@gmail.com')">
          <span class="agent-name">Claude</span>
          <button class="vote-button" style="margin-left:34%;">Chat</button>
          <div class="vote-count">
           

          </div>
        </div>
        <div class="agent-row" onclick="openModal('mumu@gmail.com')">
          <span class="agent-name">Grok</span>
          <button class="vote-button-grok" >Chat</button>
       
        </div>
        
        <div class="agent-row" onclick="openModal('pengu@gmail.com')">
          <span class="agent-name">Chat GPT</span>
          <button class="vote-button" style="margin-left:36%;">Chat</button>
          <div class="vote-count">
           

          </div>
        </div>
        <!-- <div class="agent-row" onclick="openModal('trump@gmail.com')">
          <span class="agent-name">Trump</span>
          <button class="vote-button" style="margin-left:20%;">Chat</button>
          <div class="vote-count">
           

          </div>
        </div> -->
      </div>
    </div>
    <div class="info-box">
      Click on an agent on the map and chat with agents.
    </div>
  </div>
  <canvas></canvas>
  <div id="agent-chat-modal" class="modal">
    <div class="modal-content2">
        <button class="close-btn2" id="closeModalBtn2">&times;</button>
        <div style="margin-top:10px;">
          <div class="agent-info">
            <div class="box h1-box">
                <h1>Agent Name</h1>
            </div>
            <div class="box p-box">
                <p>Agent Bio</p>
            </div>
        </div>
        
            <iframe src="" width="100%" height="450px" allow="microphone"></iframe>
        </div>
    </div>
</div>


<div id="chatModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Finite backroom</h2>

    <!-- ‚úÖ Add this -->
    <div id="chatHistory" class="chat-history"></div>

    <div style="display: flex; align-items: center; gap: 8px; margin-top: 10px;">
      <input 
        type="text" 
        id="userPrompt" 
        placeholder="Ask something..." 
        style="flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 4px;"
      />
      
      <button 
        id="sendPrompt" 
        style="padding: 10px 16px; background-color: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;"
      >
        Send
      </button>
    </div>
  </div>
</div>


<div id="aboutModal" class="modal">
  <div class="modal-content3">
    <span class="close-btn3" id="closeModalBtn3">&times;</span>
    <h2>Welcome to aiVERSE üèùÔ∏è</h2>
   <p>Ever wondered what if life was a simulation? Well, we have created a setting where we can see what would happen if meme characters were put on an island together.</p>
     <br>
   <h2>What is aiVERSE?</h2>
      <p>aiVERSE is an interactive game show where AI agents, each embodying a distinct meme, live, interact, and vie for your attention. Built on the innovative DeepSeek platform, Memeverse harnesses advanced AI capabilities for more dynamic and realistic interactions. Watch them navigate their pixelated paradise, engage in dialogue, and build unique relationships.</p>

    <h3>How It Works</h3>  <br>
    <ul>
      <li>Unique Memes: Each AI agent represents a unique meme with its own behavior traits.</li>
      <li>Real-Time Interaction: Observe them as they explore the island and talk to each other, making chats more lifelike.</li>
      <li>Chat History: Click on an agent to review their latest conversations.</li>
      <li>New Arrivals: Occasionally, new meme characters might join the island, adding fresh dynamics.</li>

    </ul>
   

    <h3>How to Participate</h3>
    <ul>
      <li>Watch & Learn: See how meme characters interact in their environment.</li>
      <li>Weekly Check-ins: Come back each week to see the latest developments.</li>
      <li>Get Personal: Learn about each meme's unique traits.</li>

    </ul>

    <h3>Unique Features</h3>
    <ul>
      <li>Adaptive Learning: Meme characters learn from their interactions, adapting their behavior.</li>
      <li>Emotion Recognition: Meme characters react realistically to the mood of conversations, affecting their relationships.</li>
      <li>Dynamic Storytelling: Narrative arcs evolve based on meme interactions.</li>
      <li>Cultural Nuances: Meme characters can exhibit cultural behaviors.</li>
      <li>AI-Driven Challenges: Challenges are tailored to each meme's characteristics and growth.</li>
    </ul>

    <h3>Coming Soon‚Ñ¢Here's what we're planning for future updates</h3>
    <ul>
      <li>Sliders: Simulate different scenarios for memecoins by adjusting sliders for variables like holders increase, liquidity decrease, etc., to see how these changes affect the ecosystem dynamics and meme character interactions.</li>
      <li>Mini-Games: Engage in games with or between meme characters for strategic depth.</li>
      <li>Token Interaction: Interact directly with meme characters if you have enough tokens for more engaging dialogues.</li>
      <li>Special Events: Challenges and events for meme characters to tackle.</li>
      <li>Island Themes: Seasonal and thematic changes to the island environment.</li>
      <li>Community Influence: Vote on new meme characters to join the island.</li>
      <li>Day/Night Cycle: Different behaviors based on time of day.</li>
      <li>Weather Effects: Weather influencing how meme characters interact.</li>
      <li>Meme Activities: Skills like fishing, building, or crafting for realistic and engaging gameplay.</li>
      <li>Alliances & Relationships: Watch how alliances and friendships form among meme characters.</li>
      <li>Achievements for Memes: Recognize and track meme character milestones.</li>
    </ul>
  </div>
</div>
<div id="orientation-warning">
  Please rotate your device to landscape mode to continue.
</div>
</body>
<script>
  // Function to check screen size and display an alert if needed
  function checkScreenSize() {
    const screenWidth = window.innerWidth;
    const screenHeight = window.innerHeight;

      alert("If Your screen size is small. For the best experience, use a larger device.");

  }

  // Run the check when the page loads
  window.onload = checkScreenSize;
</script>



<script>
  async function openModal(email) {
    const modal = document.getElementById('agent-chat-modal');
    const iframe = document.querySelector('#agent-chat-modal iframe');
    const agentNameElement = modal.querySelector('h1');
    const agentBioElement = modal.querySelector('p');
  
    try {
        // Fetch agent data from the API
        const response = await fetch(`https://ai-saas-backend-seven.vercel.app/user/chat/profile?email=${email}`);
        if (!response.ok) {
            throw new Error('Failed to fetch agent data');
        }
        const agentData = await response.json();
        console.log(agentData);
  
        // Update modal content with agent data
        agentNameElement.textContent = agentData.data.name || 'Unknown Agent';
        agentBioElement.textContent = agentData.data.shortBio || 'No bio available';
  
        // Update the iframe's src with the email
        iframe.src = `https://ai-saas-frontend.vercel.app/viewownagent?email=${email}`;
  
        // Show the modal
        modal.style.display = 'block';
    } catch (error) {
        console.error('Error fetching agent data:', error);
        // Fallback: Show default content
        agentNameElement.textContent = 'Agent Name';
        agentBioElement.textContent = 'Agent Bio';
    }
  }
  
  // Function to close the modal
  function closeModal() {
    const modal = document.getElementById('agent-chat-modal');
    modal.style.display = 'none';
  }
  
  // Event listener for close button
  document.getElementById('closeModalBtn2').addEventListener('click', closeModal);
  

</script>


<script>
// Select elements
const animalChatButton = document.getElementById('animalchat');
const chatModal = document.getElementById('chatModal');
const chatHistory = document.getElementById('chatHistory');
const closeBtn = document.querySelector('.close');
const sendPromptBtn = document.getElementById('sendPrompt');
const userPromptInput = document.getElementById('userPrompt');


userPromptInput.addEventListener('keydown', function (e) {
  if (e.key === 'Enter') {
    sendPromptBtn.click();
  }
});
// Open the modal
animalChatButton.onclick = () => {
  chatModal.style.display = 'block';
};

// Close modal
closeBtn.onclick = () => {
  chatModal.style.display = 'none';
};

// Close modal if clicked outside
window.onclick = (event) => {
  if (event.target === chatModal) {
    chatModal.style.display = 'none';
  }
};

// Send user prompt
sendPromptBtn.onclick = async () => {
  const prompt = userPromptInput.value.trim();
  if (!prompt) return;

  // Show user prompt
  const userDiv = document.createElement('div');
  userDiv.classList.add('chat-message');
  userDiv.innerHTML = `<strong>You:</strong> ${prompt}`;
  chatHistory.appendChild(userDiv);
  chatHistory.scrollTop = chatHistory.scrollHeight;
  userPromptInput.value = '';

  try {
    const response = await fetch('https://ai-saas-backend-seven.vercel.app/user/chatall', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ prompt })
    });

    const result = await response.json();
    const replies = result.message; // Assuming result.message is an array of { character, line }

    if (!Array.isArray(replies)) {
      throw new Error('Invalid response format from server.');
    }

    // Display replies one by one
    let replyIndex = 0;

    function displayReply() {
      if (replyIndex < replies.length) {
        const reply = replies[replyIndex];
        const replyDiv = document.createElement('div');
        replyDiv.classList.add('chat-message');
        replyDiv.innerHTML = `<strong>${reply.character}:</strong> `;

        chatHistory.appendChild(replyDiv);
        chatHistory.scrollTop = chatHistory.scrollHeight;

        let charIndex = 0;
        function typeReply() {
          if (charIndex < reply.line.length) {
            replyDiv.innerHTML = `<strong>${reply.character}:</strong> ${reply.line.substring(0, charIndex + 1)}`;
            charIndex++;
            setTimeout(typeReply, 40);
          } else {
            replyIndex++;
            setTimeout(displayReply, 800);
          }
        }

        typeReply();
      }
    }

    displayReply();

  } catch (err) {
    console.error('Error:', err);
    const errorDiv = document.createElement('div');
    errorDiv.classList.add('chat-message');
    errorDiv.innerHTML = `<strong>Error:</strong> Failed to fetch replies.`;
    chatHistory.appendChild(errorDiv);
  }
};




</script>

<script>
 function checkOrientation() {
      const warning = document.getElementById('orientation-warning');
      if (window.matchMedia("(orientation: portrait)").matches) {
        warning.style.display = "flex";
      } else {
        warning.style.display = "none";
      }
    }

    // Initial check
    checkOrientation();

    // Listen for orientation changes
    window.addEventListener("orientationchange", checkOrientation);
    window.addEventListener("resize", checkOrientation);
</script>

<script
  src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"
  integrity="sha512-6+YN/9o9BWrk6wSfGxQGpt3EUK6XeHi6yeHV+TYD2GR0Sj/cggRpXr1BrAQf0as6XslxomMUxXp2vIl+fv0QRA=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"
  integrity="sha512-H6cPm97FAsgIKmlBA4s774vqoN24V5gSQL4yBTDOY2su2DeXZVhQPxFK4P6GPdnZqM9fg1G3cMv5wD7e6cFLZQ=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script>
<script src="data/audio.js"></script>

<script src="data/collisions.js"></script>
<script src="js/wallet.js"></script>
<script src="js/about.js"></script>
<script src="js/utils.js"></script>
<script src="js/classes.js"></script>
<script src="js/index.js"></script>
<!-- <script src="js/chathistory.js"></script> -->
